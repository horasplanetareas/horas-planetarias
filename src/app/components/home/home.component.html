<div class="header">
  <!-- Día y subdía -->
  <h2>{{ diaActual }}</h2>
  <h3 class="subdia">{{ subDia }}</h3>

  <!-- Fecha y hora actual -->
  <div class="fecha-hora">
    <p class="fecha">{{ fechaActual }}</p>
    <span class="separador">|</span>
    <p class="hora">{{ horaActual }}</p>
  </div>

  <!-- Bloque planeta regente -->
  <ng-container *ngIf="planeta; else noEncontrado">
    <div [ngClass]="['detalle-card', planeta?.nombre?.toLowerCase() || '']">

      <!-- Título fijo -->
      <h1>Planeta regente del día</h1>
      <h3>{{ planeta?.nombre }}</h3>

      <!-- ================= Vista logueado ================= -->
      <ng-container *ngIf="isLoggedIn">

        <!-- Descripción completa -->
        <p>{{ planeta?.descripcion }}</p>

        <!-- Carousel con actividades completas -->
        <div id="carouselPlanetaDetalle" class="carousel slide" data-bs-ride="carousel"
          *ngIf="(planeta?.actividades?.length || 0) > 0">
          <div class="carousel-inner">

            <!-- Iteración de actividades -->
            <div *ngFor="let act of (planeta?.actividades || []); let i = index"
              [class.carousel-item]="true"
              [class.active]="i === 0">

              <img [src]="act?.imagen" class="d-block w-100" alt="{{ act?.titulo }}">

              <!-- Texto sobre imagen (PC/tablet) -->
              <div class="carousel-caption d-none d-md-block custom-caption rounded p-2">
                <h5>{{ act?.titulo }}</h5>
                <p>{{ act?.descripcion }}</p>
              </div>

              <!-- Texto debajo (móviles) -->
              <div class="caption-mobile text-center">
                <h5>{{ act?.titulo }}</h5>
                <p>{{ act?.descripcion }}</p>
              </div>

            </div>
          </div>

          <!-- Controles -->
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselPlanetaDetalle"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
            <span class="visually-hidden">Anterior</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselPlanetaDetalle"
            data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
            <span class="visually-hidden">Siguiente</span>
          </button>
        </div>

        <!-- Párrafo final -->
        <p>{{ planeta?.parrafoFinal }}</p>
      </ng-container>
    </div>
  </ng-container>

  <!-- Si no hay planeta -->
  <ng-template #noEncontrado>
    <p>Planeta no encontrado.</p>
  </ng-template>
</div>
